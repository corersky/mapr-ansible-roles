
- hosts: localhost
  roles:
    - { role: mapr-aws-bootstrap,
        ec2_keypair: 'vgonzalez_keypair',
        ec2_security_group: 'sg-b7e12fde',
        ec2_region: 'us-east-1',
        ec2_zone: 'us-east-1b', # use with subnet-8f999ba7
        ec2_image: 'ami-8997afe0',
        vpc_subnet: 'subnet-4fb47638',
        ec2_name_tag: 'MSG',
        edge_node_count: 1,
        edge_node_type: 'm1.medium',
        edge_node_price: 0.032,
        cluster_node_count: 5,
        cluster_node_type: 'm1.large',
        cluster_node_price: 0.096,
        ec2_wait_timeout: 1200
    }

# NB: instances is dynamically created in the bootstrap play above.
# don't look for it in the inventory file.
- hosts: instances
  tasks:
    - name: extend root FS to fill volume in case it's larger than the base AMI
      command: resize2fs /dev/xvde

# - hosts: localhost
#   tasks:
#     - name: debug ec2_cluster
#       debug: var=ec2_cluster

#     - name: update Route53 for local DNS
#       local_action:
#         module: route53
#         command: create
#         zone: maprdemo.internal
#         record: "{{item.id}}.maprdemo.internal"
#         overwrite: true
#         type: "A"
#         value: "{{item.private_ip}}"
#       with_items:
#         - "{{ec2_cluster.instances}}"

